\usepackage{wasysym}%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LAB-5 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%>>>>>>>>>>>>>>>>>>>>>>>>>> ПЕРЕМЕННЫЕ >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

%>>>>> Информация о кафедре
%\newcommand{\year}{2021 г.}  % Год устанавливается автоматически
\newcommand{\city}{Санкт-Петербург}  %  Футер, нижний колонтитул на титульном листе
\newcommand{\university}{Национальный исследовательский университет ИТМО}  % первая строка
\newcommand{\department}{Факультет программной инженерии и компьютерной техники}  % Вторая строка
\newcommand{\major}{Направление программная инженерия}  % Треьтя строка
% Пусть будет. Проще закоментить лишнее.
\newcommand{\education}{Образовательная программа системное и прикладное программное обеспечение}  % четвертая строка
%\newcommand{\specialization}{}  % пятая строка

%<<<<< Информация о кафедре
%Ашч
%>>>>> Назание работы
\newcommand{\reporttype}{ОТЧЕТ ПО ЛАБОРАТОРНОЙ РАБОТЕ} % тип работы, (главный заголовок титульного листа)
\newcommand{\lab}{Лабораторная работа}          % вид работы
\newcommand{\labnumber}{№ 1}                    % порядковый номер работы
\newcommand{\subject}{Основы профессианальной деятельности}         % учебный предмет
\newcommand{\labtheme}{Основы работы с файловой системой и управления правами доступа в Linux}            % Тема лабораторной работы
\newcommand{\variant}{№ 90019}                % номер варианта работы
\newcommand{\student}{Мухамедьяров Артур Альбертович}    % определение ФИО студента
\newcommand{\studygroup}{P3109}                 % определение учебной группы
\newcommand{\teacher}{% принимающий
    Клименков С. В.,\\[1mm]% ФИО лектора
    Бострикова Д. К.% ФИО практика
}
%<<<<<<<<<<<<<<<<<<<<<<<<<< ПЕРЕМЕННЫЕ <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


%>>>>>>>>>>>>>>>>>>>>>> ПРЕАМБУЛА >>>>>>>>>>>>>>>>>>>>>>>>>
\include{preamble}
%<<<<<<<<<<<<<<<<<<<<<< ПРЕАМБУЛА <<<<<<<<<<<<<<<<<<<<<<<<<


%%%%%%%%%%%%%%%%%%% СОДЕРЖИМОЕ ОТЧЕТА %%%%%%%%%%%%%%%%%%%%%
%>>>>>>>>>>>>>>> ''''''''''''''''''''''' >>>>>>>>>>>>>>>>>>
\begin{document}


%>>>>>>>>>>>>>>>> ОПРЕДЕЛЕНИЕ НАЗВАНИЙ >>>>>>>>>>>>>>>>>>>>
% Переоформление некоторых стандартных названий
%\renewcommand{\chaptername}{Лабораторная работа}
    \renewcommand{\chaptername}{\lab\ \labnumber} % переименование глав
    \renewcommand{\contentsname}{Содержание} % переименование оглавления
%<<<<<<<<<<<<<<<< ОПРЕДЕЛЕНИЕ НАЗВАНИЙ <<<<<<<<<<<<<<<<<<<<
% \setlength{\itemsep}{0pt} % установка расстояния между строчками в списках можно использовать локально внутри списка списке
% \setlength{\parskip}{0pt} % 
% \setlength{\parsep}{0pt}  % 

%>>>>>>>>>>>>>>>>> ТИТУЛЬНАЯ СТРАНИЦА >>>>>>>>>>>>>>>>>>>>>
    \include{titlepage}
%<<<<<<<<<<<<<<<<< ТИТУЛЬНАЯ СТРАНИЦА <<<<<<<<<<<<<<<<<<<<<


%>>>>>>>>>>>>>>>>>>>>> СОДЕРЖАНИЕ >>>>>>>>>>>>>>>>>>>>>>>>>
% Содержание
    \tableofcontents
%<<<<<<<<<<<<<<<<<<<<< СОДЕРЖАНИЕ <<<<<<<<<<<<<<<<<<<<<<<<<


%%%%%%%%%%%%%%%%%%%%%%% КОД РАБОТЫ %%%%%%%%%%%%%%%%%%%%%%%%
%>>>>>>>>>>>>>>>>>>>'''''''''''''''''>>>>>>>>>>>>>>>>>>>>>
    \newpage
    \Chapter{\lab\ \labnumber}{\labtheme}{}

    \Section{Задание варианта \variant}

%    \begin{center}
%        , , ,
%    \end{center}
%    \noindent
%    \textbf{
%    % Заглавное описание....:
%        Заголовок
%    }
%
%    \textit{
%    % Описание задания...
%        Описание
%    }
    \begin{enumerate}
        \item Создать приведенное в варианте дерево каталогов и файлов с содержимым. В качестве корня дерева использовать каталог lab0 своего домашнего каталога. Для создания и навигации по дереву использовать команды: `mkdir`, `echo`, `cat`, `touch`, `ls`, `pwd`, `cd`, `more`, `cp`, `rm`, `rmdir`, `mv`.
        %    Вставленное изображение с описанием и шириной по тексту.
        \begin{figure}[H] % 'H' -- вставить тут же (подключен модуль), обычный вариант: 'htpb'
            \centering
            % { граница для иллюстрации
            % \setlength{\fboxsep}{0pt}% убрать отсутп от границы
            % \setlength{\fboxrule}{1pt}%
            % \fbox{%
            \includegraphics[width=\textwidth]{res/tree}
            % }} % ограничение области действия параметров
            \caption{Дерево каталогов и файлов}
            \label{fig:enter-label}
        \end{figure}

        \item Установить согласно заданию права на файлы и каталоги при помощи команды `chmod`, используя различные способы указания прав.
        \begin{itemize}
            \item `electrode3`: владелец должен читать и записывать файл; группа-владелец должна записывать файл; остальные пользователи должны не иметь никаких прав
            \item `igglybuff7`: `rw--w----`
            \item `leafeon5`: `r--------`
            \item `mudkip3`: `-wxrw--wx`
            \item `accelgor`: `r--------`
            \item `psyduck`: владелец должен читать и записывать файл; группа-владелец должна не иметь никаких прав; остальные пользователи должны не иметь никаких прав
            \item `vulpix`: права `755`
            \item `glaceon`: `r-----r--`
            \item `mareep`: права `006`
            \item `zorua`: права `404`
            \item `sandslash0`: `r-x-w-r--`
            \item `houndoom`: владелец должен записывать директорию и переходить в нее; группа-владелец должна только переходить в директорию; остальные пользователи должны только переходить в директорию
            \item `rapidash`: `r-x--x-wx`
            \item `aipom`: владелец должен читать директорию и переходить в нее; группа-владелец должна читать, записывать директорию и переходить в нее; остальные пользователи должны записывать директорию и переходить в нее
            \item `scraggy`: права `500`
            \item `weezing1`: `r-xrwx-wx`
            \item `larvesta`: права `771`
            \item `tangela`: права `664`
            \item `venipede`: владелец должен записывать директорию и переходить в нее; группа-владелец должна записывать директорию и переходить в нее; остальные пользователи должны записывать директорию и переходить в нее
            \item `ducklett`: права `357`
            \item `magikarp`: `rwxr-x-wx`
        \end{itemize}

        \item Скопировать часть дерева и создать ссылки внутри дерева согласно заданию при помощи команд `cp` и `ln`, а также команды `cat` и перенаправления ввода-вывода.
        \begin{itemize}
            \item создать символическую ссылку с именем `Copy\_38` на директорию `mudkip3` в каталоге `lab0`
            \item создать символическую ссылку для файла `leafeon5` с именем `lab0/mudkip3/psyduckleafeon`
            \item объединить содержимое файлов `lab0/mudkip3/mareep`, `lab0/mudkip3/psyduck`, в новый файл `lab0/igglybuff7\_78`
            \item скопировать рекурсивно директорию `sandslash0` в директорию `lab0/weezing1/venipede`
            \item скопировать содержимое файла `electrode3` в новый файл `lab0/mudkip3/accelgorelectrode`
            \item скопировать файл `leafeon5` в директорию `lab0/sandslash0/aipom`
            \item создать жесткую ссылку для файла `igglybuff7` с именем `lab0/mudkip3/mareepigglybuff`
        \end{itemize}

        \item Используя команды `cat`, `wc`, `ls`, `head`, `tail`, `echo`, `sort`, `grep` выполнить в соответствии с вариантом задания поиск и фильтрацию файлов, каталогов и содержащихся в них данных.
        \begin{itemize}
            \item Подсчитать количество символов содержимого файлов в директории `mudkip3`, результат записать в файл в директории `/tmp`, ошибки доступа перенаправить в файл в директории `/tmp`
            \item Вывести два последних элемента рекурсивного списка имен и атрибутов файлов в директории `lab0`, содержащих строку ``on'', список отсортировать по убыванию даты доступа к файлу, подавить вывод ошибок доступа
            \item Вывести содержимое файлов: `psyduck`, `glaceon`, `mareep`, `zorua`, исключить строки, заканчивающиеся на 'r', ошибки доступа перенаправить в файл в директории `/tmp`
            \item Вывести содержимое файлов с номерами строк в директории `mudkip3`, оставить только строки, содержащие ``ck'', регистр символов игнорировать, ошибки доступа не подавлять и не перенаправлять
            \item Рекурсивно подсчитать количество символов содержимого файлов из директории `lab0`, имя которых начинается на 'a', отсортировать вывод по увеличению количества, добавить вывод ошибок доступа в стандартный поток вывода
            \item Рекурсивно вывести содержимое файлов из директории `lab0`, имя которых заканчивается на 'p', строки отсортировать по имени a->z, ошибки доступа перенаправить в файл в директории `/tmp`
        \end{itemize}

        \item Выполнить удаление файлов и каталогов при помощи команд `rm` и `rmdir` согласно варианту задания.
        \begin{itemize}
            \item Удалить файл `leafeon5`
            \item Удалить файл `lab0/mudkip3/glaceon`
            \item удалить символические ссылки `Copy\_*`
            \item удалить жесткие ссылки `lab0/mudkip3/mareepigglybu*`
            \item Удалить директорию `weezing1`
            \item Удалить директорию `lab0/weezing1/larvesta`
        \end{itemize}
    \end{enumerate}


%    \begin{center}
%        ' ' '
%    \end{center}

    \newpage
    \Section{Выполнение задания.}
    Задание было выполнено в редакторе vim в файл \verb|lab1.sh| и загружено в Git репозиторий на GitHub. Копия репозитория находится на сервере ИТМО `Helios`.
%    \newpage
    \Subsection{Листинги кода}
    Листинг из файла~\ref{lst:bash1}
    \lstinputlisting[caption={Первая версия главного скрипта},label={lst:bash1},language=bash]{../lab1_errors.sh}

    Во время певрого выполнения кода у меня возникли следующие ошибки
    \begin{lstlisting}[caption={Первый запуск},label={lst:result1}]
    ...
    cat: /home/studs/s375301/lab0/mudkip3/mareep: Permission denied
    cp: /home/studs/s375301/lab0/sandslash0/aipom/leafeon5: Permission denied
    ...
    override r-xrwx-wx s375301/studs uarch for /home/studs/s375301/lab0/weezing1? y
    rm: /home/studs/s375301/lab0/weezing1/tangela: Permission denied
    rm: /home/studs/s375301/lab0/weezing1/ducklett: Permission denied
    rm: /home/studs/s375301/lab0/weezing1/magikarp: Permission denied
    rm: /home/studs/s375301/lab0/weezing1/larvesta: Permission denied
    override r-x-w-r-- s375301/studs uarch for /home/studs/s375301/lab0/weezing1/venipede? y
    override r-xrwx-wx s375301/studs uarch for /home/studs/s375301/lab0/weezing1/venipede/aipom? y
    rm: /home/studs/s375301/lab0/weezing1/venipede/aipom: Permission denied
    override r-x--x-wx s375301/studs uarch for /home/studs/s375301/lab0/weezing1/venipede/rapidash? y
    rm: /home/studs/s375301/lab0/weezing1/venipede/rapidash: Permission denied
    override r-x--x--x s375301/studs uarch for /home/studs/s375301/lab0/weezing1/venipede/houndoom? y
    rm: /home/studs/s375301/lab0/weezing1/venipede/houndoom: Permission denied
    override r-x------ s375301/studs uarch for /home/studs/s375301/lab0/weezing1/venipede/scraggy? y
    rm: /home/studs/s375301/lab0/weezing1/venipede/scraggy: Permission denied
    rm: /home/studs/s375301/lab0/weezing1/venipede: Permission denied
    rm: /home/studs/s375301/lab0/weezing1: Directory not empty
    rm: /home/studs/s375301/lab0/weezing1/larvesta: Permission denied
    ...
    \end{lstlisting}

    Для их решения я добавил в код главного скрипта следующие пункты
    \begin{lstlisting}[caption={Добавление изменения прав},label={lst:codeedit}]
    chmod u+r ~/lab0/mudkip3/mareep
    cat ~/lab0/mudkip3/mareep ~/lab0/mudkip3/psyduck > ~/lab0/igglybuff7_78
    chmod u-r ~/lab0/mudkip3/mareep
        ...
    chmod u+w ~/lab0/sandslash0/aipom
    cp ~/lab0/leafeon5 ~/lab0/sandslash0/aipom/
    chmod u-w ~/lab0/sandslash0/aipom
        ...
    chmod -R u+rwx ~/lab0/weezing1
    rm -r ~/lab0/weezing1
        ...
    \end{lstlisting}

    Теперь скрипт выглядит так

    Листинг из файла~\ref{lst:bash}
    \lstinputlisting[caption={Исходный код главного скрипта},label={lst:bash},language=bash]{../lab1.sh}

%    Листинг в код latex \ref{lst:sql}
%    \begin{lstlisting}[caption={SQL},label={lst:sql}]
%declare @t table(
%  id int
%)
%    \end{lstlisting}

%    Листинг прямо в текст: \lstinline[columns=fixed]{declare}. Либо еще так: \verb|declare|.

%    Вставленное изображение с описанием и шириной по тексту.
%    \begin{figure}[H] % 'H' -- вставить тут же (подключен модуль), обычный вариант: 'htpb'
%        \centering
%        % { граница для иллюстрации
%        % \setlength{\fboxsep}{0pt}% убрать отсутп от границы
%        % \setlength{\fboxrule}{1pt}%
%        % \fbox{%
%        \includegraphics[width=\textwidth]{res/UML-class-diagram.png}
%        % }} % ограничение области действия параметров
%        \caption{UML диаграмма классов с методами и полями}
%        \label{fig:enter-label2}
%    \end{figure}


% Выполнение задания...
    \Section{Результат работы программы.}
%    \Subsection{Первый запуск.}
    \begin{lstlisting}[caption={Результат выполнения программы},label={lst:result}]
гойда
    \end{lstlisting}

    \Section{Вывод}
% Вывод...
    Во время выполненния лабораторный работы я освоил базовые команды работы с файловой системой, базовый инструментарий командной оболочки и изучил права доступа в Linux. Также в процессе выполнения я тесно работал с командой man, с документацией на Archwiki и Gentoo wiki. Полученные мною знания являются необходимым минимумом для дальнейшего изучения GNU/Linux и выполнения более сложных действий.
% -- из biblist
    \newpage
%<<<<<<<<<<<<<<<<<<<<<< КОД РАБОТЫ <<<<<<<<<<<<<<<<<<<<<<<<


%>>>>>>>>>>>>>>>> СПИСОК ЛИТЕРАТУРЫ >>>>>>>>>>>>>>>>>>>>>>>
    \include{biblist}  % Для соответсвия гост, придется доработать. Нужен файл .bib
%<<<<<<<<<<<<<<<<<<<< СПИСОК ЛИТЕРАТУРЫ <<<<<<<<<<<<<<<<<<<


\end{document}
%<<<<<<<<<<<<<<<< ,,,,,,,,,,,,,,,,,,,,,,, <<<<<<<<<<<<<<<<<
%<<<<<<<<<<<<<<<<<<< СОДЕРЖИМОЕ ОТЧЕТА <<<<<<<<<<<<<<<<<<<<
